%token TK_SS, TK_IMM, TK_BQEDS, TK_YUZOZ, TK_ON, TK_LFTP, TK_AZ, TK_ARJ, TK_ISIWH, TK_KPO, TK_PGEZ, TK_ADRF, TK_DXSZ, TK_OC;

%nodefault

root: TOYPM TK_KPO TOYPM TK_BQEDS TK_YUZOZ | TK_AZ RIC RIC | 'K' | TK_PGEZ TK_KPO TK_YUZOZ | 'X' TK_OC;

NL: AAA TK_BQEDS BV | BCSI | TOYPM 'X' RF TK_OC GSBBT | TK_PGEZ TK_ISIWH RJ 'K' | ;

NI: NL TK_IMM NL RKUUX GSBBT | NL 'X' TK_BQEDS 'X' | TK_ON NL LN TK_IMM NI | RF BCSI | 'K';

AAA: TK_SS NI TOYPM;

GVTPU: 'K' | TK_YUZOZ BCSI | TK_AZ TK_ON | BCSI GVTPU TK_YUZOZ V TOYPM;

JZ: 'Y' RKUUX TK_DXSZ GSBBT | RIC TK_ADRF BY TK_ADRF TK_KPO | GVTPU 'Y' LN RIC JZ;

GSBBT: JZ NL 'K' NI BCSI | TK_AZ TK_IMM BCSI;

LN: RKUUX | BY TOYPM TK_AZ GSBBT | TK_LFTP | TK_ARJ TK_IMM | V BCSI TK_ON;

RF: 'K' BV BCSI | NI TK_LFTP GVTPU TK_SS;

RIC: 'Y' TK_ADRF TK_PGEZ GVTPU TK_ISIWH;

BV: V QBP BV QBP V | TOYPM RJ TK_ADRF | RKUUX LN RKUUX | TK_ISIWH RIC TK_OC 'K' | ;

RJ: BY NI TK_ISIWH | GSBBT;

V: 'Y' TK_SS TK_OC TK_SS | GSBBT TK_PGEZ NL TK_ON BY | TK_PGEZ TK_SS TK_BQEDS RJ JZ | NL;

TOYPM: V TK_IMM TK_SS | 'X';

BCSI: BY TK_LFTP TK_ADRF GSBBT JZ | TK_SS RF | BCSI TK_YUZOZ GVTPU | BV BY GVTPU | ;

QBP: V TK_LFTP GSBBT LN | BY GVTPU TK_IMM TK_YUZOZ | BY JZ RJ GSBBT | QBP TK_KPO | TK_ADRF TK_KPO BV RF;

BY: TK_OC NI | TK_DXSZ BV 'Y' | TK_DXSZ TK_ON | RIC | TK_BQEDS QBP TK_IMM 'D' TK_BQEDS;

RKUUX: TK_AZ 'D' BCSI | TK_PGEZ BY TK_DXSZ 'D' GSBBT | 'X' TK_AZ 'K';


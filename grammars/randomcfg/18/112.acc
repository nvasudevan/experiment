%token TK_SS, TK_IMM, TK_BQEDS, TK_YUZOZ, TK_ON, TK_LFTP, TK_AZ, TK_ARJ, TK_ISIWH, TK_KPO, TK_PGEZ, TK_ADRF, TK_DXSZ, TK_OC;

%nodefault

root: LN NI TOYPM | NI BY LN BY | TK_ADRF TK_ISIWH TK_YUZOZ | TK_BQEDS TK_DXSZ TK_LFTP TK_SS | TK_BQEDS 'K' BCSI JZ;

NL: BV TK_ON RIC V | NL BCSI | TK_LFTP TK_IMM TK_OC BV TK_BQEDS | RJ V | 'Y';

NI: JZ AAA 'D' BCSI RKUUX | RJ | TK_LFTP TOYPM GSBBT TK_OC | 'D' QBP TK_DXSZ TK_BQEDS | RKUUX TK_LFTP GVTPU 'Y' NI;

AAA: TK_AZ TK_ADRF NI RKUUX TK_OC | GVTPU 'D' TK_AZ | ;

GVTPU: 'K' | BV;

JZ: AAA TOYPM RKUUX | TK_ARJ BCSI | NI TK_YUZOZ BY TK_YUZOZ NI | JZ V;

GSBBT: RKUUX RF NI TK_AZ;

LN: TK_OC AAA TK_ADRF | GVTPU TK_DXSZ V TK_OC 'K' | TK_YUZOZ BCSI | TK_BQEDS TK_BQEDS 'D' TK_OC TOYPM | TK_YUZOZ TK_BQEDS JZ TOYPM;

RF: TK_AZ 'X' TK_AZ TOYPM 'Y';

RIC: TOYPM RF TK_KPO TK_LFTP V | TK_ON RJ LN BV TK_ON | TK_KPO | BCSI TK_SS | BY GSBBT RKUUX;

BV: GVTPU V TK_ON | AAA | TK_ON AAA BY | ;

RJ: RJ | TK_PGEZ TK_ARJ RIC BY | TK_LFTP AAA | TK_KPO GVTPU 'K' 'Y' TK_LFTP;

V: TK_KPO TK_BQEDS BV TK_ON TK_OC | TK_ADRF | QBP RJ TK_PGEZ | AAA | ;

TOYPM: TK_IMM 'K' | TK_LFTP;

BCSI: TK_ON JZ | TOYPM TK_ARJ AAA LN | RJ LN | TOYPM TK_LFTP TK_LFTP;

QBP: NI | 'Y' 'K' NI QBP | TK_AZ GSBBT RF TK_IMM;

BY: 'X' TK_AZ TK_YUZOZ TK_YUZOZ | GSBBT | TOYPM JZ TK_ISIWH | TK_ISIWH TK_DXSZ TK_ARJ GVTPU RKUUX | NI TK_ISIWH NI;

RKUUX: TK_SS TK_OC | TK_DXSZ TK_PGEZ RJ BCSI;


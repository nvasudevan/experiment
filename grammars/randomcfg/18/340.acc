%token TK_SS, TK_IMM, TK_BQEDS, TK_YUZOZ, TK_ON, TK_LFTP, TK_AZ, TK_ARJ, TK_ISIWH, TK_KPO, TK_PGEZ, TK_ADRF, TK_DXSZ, TK_OC;

%nodefault

root: TK_ON TK_IMM 'X' RJ;

NL: TK_OC RJ RJ | V TK_ADRF NL TK_SS | TK_ON 'D' V TK_ISIWH GVTPU | TK_AZ TK_DXSZ TK_YUZOZ TK_YUZOZ GSBBT | TK_ADRF TK_ADRF GSBBT 'K' 'D';

NI: BY TK_ON TK_ISIWH | RF QBP NI 'K' | 'Y' | GSBBT TK_IMM TK_PGEZ RIC V;

AAA: BCSI TK_PGEZ RF RJ | TK_ON 'Y' | TK_ARJ TK_IMM 'D' TK_KPO AAA;

GVTPU: TK_PGEZ GVTPU 'D' TK_DXSZ | TK_ADRF GSBBT TK_AZ;

JZ: TK_LFTP TOYPM TK_IMM NI | TK_ON LN TK_DXSZ NL TK_SS | 'X' TK_BQEDS;

GSBBT: 'X' 'K' | JZ TK_OC QBP | QBP RF | GVTPU TK_ARJ BY 'X' JZ | NI;

LN: RKUUX;

RF: 'Y' NI TOYPM BV TK_ADRF | RF RJ;

RIC: 'D' | TK_AZ TK_ARJ NL | TOYPM TK_AZ TK_BQEDS JZ AAA | 'K' TK_DXSZ BY RKUUX;

BV: 'D' NL BCSI | GVTPU V TOYPM | TK_OC RKUUX | TK_YUZOZ TK_ADRF GSBBT RJ RKUUX | NI;

RJ: TK_SS TK_YUZOZ TK_KPO | NI GSBBT TOYPM TK_ADRF TK_LFTP | TK_ADRF LN TK_AZ BV RIC | TK_LFTP BV TK_IMM TK_LFTP TOYPM | TK_BQEDS V TK_BQEDS 'D' TK_SS;

V: TK_ADRF TK_DXSZ TK_IMM | QBP 'X' TK_PGEZ TK_AZ QBP;

TOYPM: 'K' TK_ADRF;

BCSI: TK_YUZOZ TK_OC | QBP TK_IMM QBP TK_AZ | ;

QBP: RF BY | ;

BY: TK_YUZOZ BCSI LN BV TK_LFTP | LN AAA JZ TK_AZ | TK_YUZOZ | RIC TK_YUZOZ JZ;

RKUUX: TK_ADRF | TK_BQEDS;


%token TK_XZJJ, TK_PKPH, TK_XA, TK_SNJ, TK_AA, TK_QJH, TK_UBB, TK_CP, TK_YKGT, TK_VWE, TK_EYWL, TK_FWB, TK_QHA, TK_BV, TK_RUAWA, TK_LCV, TK_FMSIS, TK_KXSNQ, TK_GRC, TK_ZIF;

%nodefault

root: D;

KBHQS: NY TLXJE TK_KXSNQ TK_VWE 'O';

QRHM: 'O' | TK_KXSNQ LSQ TK_XZJJ TK_VWE | DV TK_YKGT 'O';

KDZV: TK_PKPH;

DOZLT: 'W';

FB: KJTAC LOTF FI TLXJE TK_LCV 'V' | TK_XA | TK_UBB TK_UBB TS TK_RUAWA TK_BV TK_SNJ PYXCR 'M' TK_QJH TK_AA TLXJE TK_BV SET TK_FMSIS LOTF 'W' LSQ TLXJE TK_CP D TK_UBB;

JO: NL 'V' TK_ZIF SET;

FI:  | TK_UBB WUJ RGFO TS 'W' DV KJTAC | TK_QJH;

DV: TS TK_KXSNQ TS UGP TK_RUAWA TK_BV TK_ZIF | DOZLT DOZLT TK_FMSIS | RGFO | TK_QJH D FB TK_XZJJ 'O' TK_XZJJ TK_QJH | KJTAC TK_AA;

JAUE: D | TK_PKPH TK_ZIF DV 'O' | PYXCR | FI TK_BV TK_VWE;

SET: UGP TK_VWE TK_XZJJ TK_BV;

NL: QFMT WUJ KBHQS 'Q' LOTF 'W' KBHQS TS TK_UBB TK_AA D TK_FMSIS RJ TK_FMSIS NL 'Q' SET | D JAUE RGFO TK_LCV 'Q';

QFMT: TS QFMT | TK_EYWL 'V' | 'M' | UGP TS DOZLT TK_FWB TK_UBB TK_RUAWA TK_CP TK_QHA TK_KXSNQ;

PKU: TK_KXSNQ FB TK_LCV TK_XA | TK_XZJJ;

PYXCR: FB TK_EYWL KDZV QFMT | PKU | ;

TS: PYXCR | LSQ TK_SNJ TK_PKPH PKU TK_FWB LUDG TK_BV | WUJ PYXCR;

NY: QRHM UGP | PKU 'O' TK_KXSNQ TK_KXSNQ TK_FWB;

RGFO:  | 'O' TK_VWE TK_XA FI QRHM TK_FWB TK_ZIF;

LSQ: TK_XA TK_UBB TK_GRC | KBHQS SET PKU | TK_XA LSQ 'Q' NL JAUE | 'V' FB TK_EYWL;

UGP: TS 'G' | NL TK_QJH TK_LCV LSQ FI | 'V' PKU;

KJTAC: TK_QHA TK_AA FI;

LOTF: TK_BV TS QFMT RGFO | D;

RJ: TK_VWE LSQ | NY SET | LSQ RJ JAUE TK_UBB TK_LCV D | TK_ZIF TK_QHA;

D: NY;

LUDG: TK_ZIF | PKU TK_FWB FB TK_YKGT;

TLXJE: TK_UBB DV NL | 'M' WUJ 'L';

WUJ: 'W' 'M' KBHQS;


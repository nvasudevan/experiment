%token TK_XZJJ, TK_PKPH, TK_XA, TK_SNJ, TK_AA, TK_QJH, TK_UBB, TK_CP, TK_YKGT, TK_VWE, TK_EYWL, TK_FWB, TK_QHA, TK_BV, TK_RUAWA, TK_LCV, TK_FMSIS, TK_KXSNQ, TK_GRC, TK_ZIF;

%nodefault

root: LOTF;

KBHQS: TK_VWE RGFO | PYXCR TK_QJH | TK_SNJ TK_BV JAUE TK_ZIF UGP TK_SNJ | TK_LCV;

QRHM: TK_YKGT LSQ TS KBHQS PYXCR KBHQS 'Q' UGP DV;

KDZV: JO QRHM | SET TK_XA JAUE 'W' LOTF TK_FMSIS | TK_BV TK_YKGT TK_XZJJ KDZV TK_QHA | UGP TK_EYWL 'O' TK_CP D | TK_GRC;

DOZLT: SET;

FB: TK_RUAWA | D DV LSQ NY | FI TK_VWE TK_GRC DOZLT TK_FWB TK_GRC KJTAC;

JO: TK_QHA TK_QHA NY TK_GRC RJ TK_LCV TK_XZJJ | ;

FI: DV D QRHM RGFO LOTF TK_KXSNQ | 'L' TK_XZJJ TK_GRC QFMT JO | KDZV 'V' | 'L' 'L' TK_XZJJ QRHM TK_KXSNQ RJ TK_XA;

DV: TK_FWB TK_GRC | JO | QFMT LOTF KDZV 'Q' LOTF;

JAUE: TK_GRC | 'W' TK_ZIF SET TK_VWE | ;

SET: DOZLT | WUJ D WUJ 'G' LOTF | TLXJE TK_PKPH;

NL: TK_CP | QFMT LUDG PYXCR;

QFMT: LSQ KDZV | 'Q' 'G' 'M' TK_AA NY KDZV TK_QHA TK_AA PYXCR TK_YKGT TK_FWB SET KDZV TK_ZIF TK_FWB RJ TK_ZIF;

PKU: RGFO | TLXJE PKU DOZLT;

PYXCR: TK_YKGT | TK_GRC | 'W' KJTAC TK_SNJ FB TK_EYWL WUJ | KBHQS KDZV TK_FMSIS TLXJE | TK_FWB;

TS: TK_GRC FB;

NY: RJ | TK_ZIF 'W' QRHM | LOTF KBHQS;

RGFO: TK_QHA | TS TK_VWE;

LSQ: 'O' DV LOTF TK_UBB 'G';

UGP: TK_FWB | TK_QHA TK_LCV QRHM TLXJE QFMT 'M' KJTAC LUDG TK_ZIF JAUE FB;

KJTAC: LOTF NY | PKU TLXJE;

LOTF: UGP | KJTAC RGFO 'O' NL | TK_UBB LUDG | TK_FMSIS RJ TK_AA TK_RUAWA | TK_QHA TK_RUAWA;

RJ: JAUE TK_KXSNQ | QFMT 'G' PKU TK_SNJ | TK_PKPH RJ TK_YKGT TK_LCV 'M' KBHQS TK_KXSNQ TK_VWE TK_FMSIS KBHQS FI | TK_YKGT 'V' TK_XZJJ | 'O' NY TK_UBB TK_YKGT SET TK_FMSIS TK_XA RGFO NL JAUE;

D: FI;

LUDG: FI;

TLXJE: NY TK_BV | TK_SNJ | JO TK_QJH KBHQS JO | TK_YKGT | LUDG RGFO TK_XA 'O';

WUJ: 'V' TK_RUAWA JAUE TK_BV TK_BV | DOZLT WUJ DOZLT | TK_QJH FI | DOZLT 'W' TS 'V' TK_GRC;

